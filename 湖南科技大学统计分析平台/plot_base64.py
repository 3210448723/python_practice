# Author:Yuan Jinmin
# -*- coding = utf-8 -*-
# @Time  :2022/11/14 15:27
# @Author:YJM
# @Site  :
# @File  :plot_base64.py
# @Software: IntelliJ IDEA
import base64
import re

import cv2
import matplotlib.pyplot as plt
import numpy as np


def plot(img_data):
	# img_data = 'data:image/png;base64,xxxx   此处省略。。。'

	# 1、信息提取
	result = re.search("data:image/(?P<ext>.*?);base64,(?P<data>.*)", img_data, re.DOTALL)
	if result:
		ext = result.groupdict().get("ext")
		data = result.groupdict().get("data")
	else:
		raise Exception("Do not parse!")

	# 2、base64解码，转换为np数组，转换为opencv输出
	img_bytes = base64.b64decode(data)
	nparr = np.fromstring(img_bytes, np.uint8)
	img = cv2.imdecode(nparr, cv2.COLOR_BGR2RGB)

	# 转换为matplotlib输出
	plt.imshow(img)
	plt.show()


if __name__ == '__main__':
	img_data = 'data:image/jpg;base64,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'
	plot(img_data)
